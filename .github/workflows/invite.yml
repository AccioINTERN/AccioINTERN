name: Invite to AccioINTERN Organization

on:
  workflow_dispatch:
  repository_dispatch:
    types: [join-request]

jobs:
  invite:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Send Invitation
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GITHUB_ORG: AccioINTERN
        run: |
          USERNAME=${{ github.event.client_payload.username }}
          echo "Sending invitation to $USERNAME"
          curl -X POST \
            -H "Authorization: token $GITHUB_TOKEN" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/orgs/$GITHUB_ORG/invitations \
            -d '{"invitee_id":"'$USERNAME'"}'
